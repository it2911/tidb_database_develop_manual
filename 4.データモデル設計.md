# 第4　データモデル設計

データベースモデル設計とは、与えられたアプリケーション環境について適切なデータベースモデルを構築し、データベースとそのアプリケーションシステムを確立し、データを効率的に格納し、ユーザー情報と処理に関する要求に対応することをいいます。データベース設計は、開発において非常に重要なプロセスです。効率的なデータベースモデルは非常に重要で必要なものです。

### 1. インテグリティ
データベースインテグリティとは、データベースに格納されたデータの正確性と適合性をいいます。データベースインテグリティは整合性制約によって担保されます。データベースインテグリティはデータベースアプリケーションシステムにとって非常に重要であり、その役割は主に次のいくつかの面で示されます。

- 整合性コントロールメカニズムによって業務規則を実現し、定義、理解しやすく、アプリケーションプログラムの複雑性を低下させ、アプリケーションプログラムの運用効率を向上する。 
- 適切なデータベースインテグリティ設計は、データベースのインテグリティとシステムのパフォーマンスを両立させる。アプリケーションソフトウェアの機能テストで、万全のデータベースインテグリティはアプリケーションソフトウェアのエラーを早期に発見するのに役立つ。
- データベースとアプリケーションプログラムコード間にもう1つの抽象化レイヤーを提供するため、アプリケーションプログラムからデータテーブルにアクセスしなくていいように、アプリケーションプログラムに専用のビューを設置できる。これにより、データベース変更処理時の自由度の向上を実現する。

### 2. パフォーマンス 
パフォーマンスはシステムを評価するための主要な要素です。その後の手間を最小限にするため、設計段階ではパフォーマンス面に注意を払いましょう。データベース設計段階でのパフォーマンスの考慮時には、パラダイムを唯一の基準やガイドとしてはならず、設計プロセスでは実際の必要に立脚し、パフォーマンス向上を基本的な目標として設計業務を実施し、パフォーマンスを向上させるために、ときにはアンチパラダイム設計をすることもあるという点に注意が必要です。

また、設計のための方法と技術も存在します。

- 適切なフィールド型、長さを設定する。フィールド型は必要に対応しつつ、可能な限り短くする。例：intを使用できる場合、可能な限りbigintの使用を避ける。また、varchar、text型での長さとパフォーマンスはデータベースごとに異なるため、慎重に選択する必要がある。
- 効率的な主キーとインデックスを選択する。テーブルレコードは主キーかインデックスから直接か間接的に読み込まれるため、その実際のアプリケーション機能に基づいて適切な主キーかインデックスを設計する。また、インデックス長にも注意を払い、インデックス長を可能な限り短くする。
- 適度な冗長性。適度な冗長性によって相関クエリを回避し、joinクエリを減少できる。

### 3. スケーラビリティ
大規模システムでは、パフォーマンス以外にスケーラビリティも設計上の重要なポイントとなります。データベーステーブルスケーラビリティには、主にテーブルロジック構造、機能フィールドの追加、テーブルの分割などが含まれます。スケーラビリティで留意すべき原則には、次のようなものがあります。

- 1つのテーブルに対して1つのエンティティ：異なるエンティティ間に相関がある場合、単独のテーブルを1つ追加しても、従前の機能には影響を与えません。
- パーティションテーブルの使用：現在サポートする型には、RANGEパーティションとHASHパーティションがあります。RANGEパーティションは、業務での大量削除によるパフォーマンス問題に対応するため、パーティションの高速削除をサポートしています。HASHパーティションは、大量に書き込まれたデータを分割するために使用します。
